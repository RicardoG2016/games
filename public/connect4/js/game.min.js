$(document).ready(function(){function o(o){return o.id.match(/\d/g).join("")}function a(o,a){3==o?(v=!0,$("#won").css("display","block")):3==a&&(v=!0,$("#lost").css("display","block"))}function l(a,t){var e=$("canvas").not(".bDisabled"),i=Math.floor(Math.random()*e.length),c=e[i],r=o(c),s=t;0==a[r].bDisabled?n(a,r,s):l(t)}function t(o,a,l,t){0==o[a].bDisabled&&0==v&&(o[a].bDisabled=!0,$(o[a]).addClass("bDisabled"),"player"==t?($(o[a]).addClass("player"),D[a-1]="x"):($(o[a]).addClass("cpu"),D[a-1]="y"),o[a].style.webkitTransform="rotateY(180deg)",o[a].style.opacity=.7,setTimeout(function(){M[a].beginPath(),M[a].lineWidth=1,M[a].arc(25,25,17,0,2*Math.PI,!1),M[a].fillStyle=l,M[a].fill(),M[a].strokeStyle=l,M[a].stroke(),M[a].closePath()},380),d++)}function n(o,a,l,n){for(var e=a;0==o[e].bDisabled;){var i=+e+7;"object"==typeof o[i]?1==o[i].bDisabled?t(o,e,l,n):e=i:t(o,e,l,n)}}function e(){setTimeout(function(){0==v&&(42==d&&(v=!0,$("#draw").css("display","block")),r(D,h,w,m),c(D,h,w,m),s(D,h,w,m),f(D,h,w,m))},900)}function i(o){1==v&&(o=!1)}function c(o,l,t,n){function e(o,a,l){this.col=l,this.val=o[a]}for(col=0;col<7;col++)for(row=0;row<6;row++){index=col+7*row;var i=new e(o,index,col);if("z"!=i.val&&"x"==n.val&&i.val==n.val&&i.col==n.col)l++;else if("z"!=i.val&&"y"==n.val&&i.val==n.val&&i.col==n.col)t++;else{var n=new e(o,index,col);l=0,t=0}a(l,t)}}function r(o,l,t,n){for(p=0;p<42;p++){var e=o[p];"z"!=e&&"x"==n&&e==n&&row==Math.floor(p/7)?l++:"z"!=e&&"y"==n&&e==n&&row==Math.floor(p/7)?t++:(n=e,row=Math.floor(p/7),l=0,t=0),a(l,t)}}function s(o,l,t,n){for(k=0;19>k;k++){var e=o[k],i=o[k+8],c=o[k+16],r=o[k+24];"x"==e&&e==i&&i==c&&c==r?l=3:"y"==e&&e==i&&i==c&&c==r?t=3:(l=0,t=0),a(l,t)}}function f(o,l,t,n){for(k=0;22>k;k++){var e=o[k],i=o[k+6],c=o[k+12],r=o[k+18];"x"==e&&e==i&&i==c&&c==r?l=3:"y"==e&&e==i&&i==c&&c==r?t=3:(l=0,t=0),a(l,t)}}for(var d=0,v=!1,b="#34495e",u="#f1c40f",y="player",h=0,w=0,m=0,x=!1,D=[],k=0;42>k;k++)D[k]="z";for(var g=[],k=1;43>k;k++)g[k]=document.getElementById("canvas"+k),g[k].bDisabled=!1;for(var M=[],k=1;43>k;k++)M[k]=g[k].getContext("2d");$("canvas").on("click",function(){var a=this;if(0==a.bDisabled&&0==v&&0==x){x=!0;var t=o(a),c=b;n(g,t,c,y),e(),i(x),x=!1}42>d&&0==v&&0==x&&(x=!0,setTimeout(function(){l(g,u,v)},400)),e(),i(x),x=!1})});